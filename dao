 package Dao;

import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;
import javax.persistence.Query;
import Dto.Demo1;

public class Sample {
EntityManagerFactory emf=Persistence.createEntityManagerFactory("dev");
EntityManager em=emf.createEntityManager();
EntityTransaction et=em.getTransaction();

public void addEmp(int id,String name,double sal,String job)
{
et.begin();
Demo1 d1=new Demo1();
d1.setEmp_id(id);
d1.setEmp_name(name);
d1.setEmp_sal(sal);
d1.setJob_role(job);
em.persist(d1);
et.commit();
}
public void fetchEmp(int id)
{
	Demo1 e=em.find(Demo1.class, id);
			if(e!=null)
				System.out.println(e);
			else
				System.out.println("data not found");
}
public void removeEmp(int id)
{
	Demo1 e=em.find(Demo1.class, id);
	if(e!=null)
	{
		et.begin();
		em.remove(e);
		et.commit();
	}
	else
	{
		System.out.println("data not fount");
}
}

	public void updateEmpsal(int id,double sal)
	{
	Demo1 e=em.find(Demo1.class, id);
	if(e!=null)
	{
		et.begin();
		e.setEmp_sal(sal);
		em.merge(e);
		et.commit();
	}
	else
		System.out.println("data not found");
 }
	
	public void fetchAll()
	{
		Query e=em.createQuery("select a from Employee_details a");
		List<Demo1>w=e.getResultList();
		for(Demo1 f:w)
			System.out.println(f);
	}
	
	public void deleteAll()
	{
		Query e=em.createQuery("Delete from Employee_details");
		et.begin();	
		e.executeUpdate();
		et.commit(); 
	}
}
